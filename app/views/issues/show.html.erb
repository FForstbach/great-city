
<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-offset-4 col-sm-4">
      <p id="notice"><%= notice %></p>
      <%= link_to '< Go back to overview', issues_path %>
      <div id="project_detail">
        <h1><%= @issue.title.upcase %></h1>
        <h4><%= @issue.description %></h4>
        <%= image_tag @issue.photo.url(:medium) %>
        <div class="card link">
          <h3>Vote for this project</h3>
          <p><%= @issue.votes > 0 ? @issue.votes : "0" %></p>
        </div>
        <a href='', id='share-link'>Click to copy link</a>
      </div>

      <div id="map" style="width: 100%; height: 600px;"></div>

      <%= link_to 'Edit', edit_issue_path(@issue) %> |
      <%= link_to 'Back', issues_path %>
      <td><%= link_to 'Destroy', issue_path, method: :delete, data: { confirm: 'Are you sure?' } %></td>
    </div>
  </div>
</div>

<%= javascript_tag do %>
  src="https://maps.google.com/maps/api/js?key=<%= ENV["google_api_key"] %>
<% end %>

<%= javascript_tag do %>
      $(document).on('ready', function() {
        var handler = Gmaps.build('Google', { markers: { clusterer: undefined }});
        handler.buildMap({ internal: { id: 'map' } }, function(){
          markers = handler.addMarkers([
            {
              "lat": 43.3027392,
              "lng": 5.3765816,
              "infowindow": "<h1>Aix - Marseille</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/008/thumbnail/marseille.jpg?1445520529' height='200'></p>"
            },
            {
              "lat": 52.3431438,
              "lng": 4.8291689,
              "infowindow": "<h1>Amsterdam</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/011/thumbnail/amsterdam.jpg?1453219893' height='200'></p>"
            },
            {
              "lat": 33.8937913,
              "lng": 35.5017767,
              "infowindow": "<h1>Beirut</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/004/thumbnail/beirut.jpg?1445520746' height='200'></p>"
            },
            {
              "lat": -19.9156207,
              "lng": -43.9345931,
              "infowindow": "<h1>Belo Horizonte</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/018/thumbnail/BH.jpg?1467361247' height='200'></p>"
            },
            {
              "lat": 44.8418706,
              "lng": -0.5706669,
              "infowindow": "<h1>Bordeaux</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/005/thumbnail/bordeaux.jpg?1445962618' height='200'></p>"
            },
            {
              "lat": 50.8474433,
              "lng": 4.3591849,
              "infowindow": "<h1>Brussels</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/002/thumbnail/brussels.jpg?1445520592' height='200'></p>"
            },
            {
              "lat": 55.699662,
              "lng": 12.532918,
              "infowindow": "<h1>Copenhagen</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/013/thumbnail/k%C3%B8benhavn-bg.jpg?1454509826' height='200'></p>"
            },
            {
              "lat": 50.6333542,
              "lng": 3.0203766,
              "infowindow": "<h1>Lille</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/003/thumbnail/lille.jpg?1445520692' height='200'></p>"
            },
            {
              "lat": 38.7324346,
              "lng": -9.1423852,
              "infowindow": "<h1>Lisbon</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/009/thumbnail/8130866554_0faf8af6e6_k.jpg?1447424100' height='200'></p>"
            },
            {
              "lat": 51.5213244,
              "lng": -0.0766771,
              "infowindow": "<h1>London</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/014/thumbnail/2722715933_ed5a01fa23_o.jpg?1457434940' height='200'></p>"
            },
            {
              "lat": 45.764043,
              "lng": 4.835659,
              "infowindow": "<h1>Lyon</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/016/thumbnail/1024px-Lyon_basilique_de_fourvie%CC%80re.jpg?1463049986' height='200'></p>"
            },
            {
              "lat": 47.218371,
              "lng": -1.553621,
              "infowindow": "<h1>Nantes</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/012/thumbnail/nantes.jpg?1453388206' height='200'></p>"
            },
            {
              "lat": 48.8648482,
              "lng": 2.3798534,
              "infowindow": "<h1>Paris</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/001/thumbnail/15079403417_371f698d27_k.jpg?1445521241' height='200'></p>"
            },
            {
              "lat": -22.97754,
              "lng": -43.234288,
              "infowindow": "<h1>Rio de Janeiro</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/019/thumbnail/rio_1.jpg?1469439835' height='200'></p>"
            },
            {
              "lat": -23.5591728,
              "lng": -46.6801402,
              "infowindow": "<h1>SÃ£o Paulo</h1><p><img src='https://d1gofzrmx0fcbg.cloudfront.net/production/cities/city_pictures/000/000/015/thumbnail/12280389883_aecfecfc0e_h.jpg?1458582747' height='200'></p>"
            }
          ]);
          handler.bounds.extendWith(markers);
          handler.fitMapToBounds();
        });
      })
   <% end %>


<!-- <script>
  function initMap() {
    var berlinIsFine = {lat: 52.487982, lng: 13.379418};
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 9,
      center: berlinIsFine
    });
    var marker = new google.maps.Marker({
      position: berlinIsFine,
      map: map
    });
  }
</script> -->


<%= javascript_tag do %>
$(document).ready(function() {
var handler = Gmaps.build('Google');
handler.buildMap({ internal: { id: 'map' } }, function() {
markers = handler.addMarkers(<%= raw @hash.to_json %>); handler.bounds.extendWith(markers); handler.fitMapToBounds();
if (markers.length == 0) {
handler.getMap().setZoom(2);
} else if (markers.length == 1) { handler.getMap().setZoom(14);
} });
});
<% end %>



 -->
<script>
var link = document.getElementById('share-link');
link.addEventListener("click", function(event){
    event.preventDefault();
});

new Clipboard('#share-link', {
    text: function(trigger) {
        alert('Link copied to clipboard!')
        return window.location.href;
    }
});
</script>
